# 브라우저 렌더링의 원리

## 렌더링 엔진?

렌더링 엔진의 역할은 요청받은 HTML, XML과 같은 내용들을 브라우저 화면에 표시하는 일.

> **여러 종류의 렌더링 엔진**

- Gecko - 모질라, 파이어폭스
- Blink - 크롬, 오페라
- Webkit - 사파리
- Trident - 익스플로러
- EdgeHTML - 마이크로소프트 엣지

<br >
 
## 렌더링 엔진 동작 과정

![](./image/render_1.png)

<br >
 
## 1. DOM 트리 구축을 위한 HTML 파싱

**파싱은 브라우저가 코드를 이해하고 사용할 수 있는 구조로 변환하는 것**을 말합니다. HTML 문서는 HTML 파서에 의해 HTML 문서에 있는 마크업들을 **파싱 트리**로 변환시킵니다. 파싱 트리는 노드 트리, DOM 트리라고도 불리며 안에는 **DOM 요소와 속성**이 담겨 있습니다. 그 다음 CSS 파일과 스타일 요소들도 파싱을 진행하여 나온 스타일 규칙과 DOM 트리를 결합하여 **렌더 트리**라는 또 다른 트리를 생성합니다.

<br >
 
### 2. 렌더 트리 구축

**렌더 트리는 표시해야 할 순서와 문서의 시각적인 구성 요소를 올바른 순서로 그려낼 수 있도록 도와줍니다.** 이 구성 요소를 **렌더러** 또는 **렌더 객체**라고 부릅니다. 렌더러는 너비, 높이, 위치와 같은 정보들을 포함하여 자신과 자식 요소를 어떻게 배치하고 그려내야 하는지 알고 있습니다.

<br >
 
### 3. 렌더 트리 배치

**렌더 트리에 있는 크기와 위치 정보를 계산하는 과정**을 배치 또는 리플로라고 부릅니다. 배치는 반복되며 HTML 문서의 최상위 렌더러부터 시작됩니다. 배치 과정을 자세하게 보자면 부모 렌더러가 자신의 너비를 계산하고 결정합니다. 그 부모의 자식 렌더러를 검토하여 크기와 위치에 맞게 배치 시킵니다. 다시 부모로 돌아와 자식의 누적된 높이와 여백, 패딩을 이용하여 자신의 높이를 설정하고 배치합니다.

<br >
 
### 4. 렌더 트리 그리기

그리기 단계에선 화면에 내용을 표시하기 위한 렌더 트리가 탐색되고 렌더러의 paint 메소드가 호출되고 CSS의 박스 모델과 위치, 배경과 같은 속성들을 참고하여 화면 상에 그려집니다.

만약 브라우저가 동적으로 변경된다면 변경된 요소의 리페인팅이 발생됩니다. 요소의 위치가 바뀐다면 요소와 자식 그리고 형제들이 전부 리페인팅되고 재배치가 되어집니다. DOM 노드를 추가하는 행위도 리페인팅과 재배치가 발생합니다.
